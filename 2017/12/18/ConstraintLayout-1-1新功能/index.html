<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description" content="study life"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>ConstraintLayout 1.1新功能 - alonealice</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com/earthWo"><span>Github</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="https://img.zcool.cn/community/014177554b6ae7000001bf729a3698.jpg@1280w_1l_0o_100sh.jpg"><div class="post-title"><h1 class="title">ConstraintLayout 1.1新功能</h1><ul class="meta"><li><i class="icon icon-author"></i>alonealice</li><li><i class="icon icon-clock"></i>15 Minutes</li><li><i class="icon icon-calendar"></i>2017年12月18日</li></ul></div></div><div class="article-content" style="max-width:800px"><p>在<a href="http://whitelife.win/2017/12/18/ConstraintLayout%E5%88%9D%E6%AD%A5%E6%8E%A2%E7%A9%B6" target="_blank" rel="noopener">ConstraintLayout初步探究</a>中简单的介绍了<code>ConstraintLayout</code>的几个实用的属性，那些都是基于1.0.2的版本的功能。今年的google开发者大会，google为我们带来了新的<code>ConstraintLayout</code>。那么新版的<code>ConstraintLayout</code>又有哪些新的功能呢。</p>
<p>首先，本文基于的版本为1.1.0-beta3.</p>
<p>引用该版本：<code>compile &#39;com.android.support.constraint:constraint-layout:1.1.0-beta3&#39;</code></p>
<h4 id="宽、高度比例"><a href="#宽、高度比例" class="headerlink" title="宽、高度比例"></a>宽、高度比例</h4><p>在之前的版本中，如果设置宽度或高度为0dp，View的相应宽、高度会自动撑满布局，这个可以通过设置layout_constraintHeight_default来改变。在1.1版本中，我们可以设置layout_constraintHeight_default=”percent”，同时设置layout_constraintWidth_percent=”0.4”，该属性的值为0-1。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;View</span><br><span class="line">       android:layout_width=&quot;0dp&quot;</span><br><span class="line">       android:layout_height=&quot;100dp&quot;</span><br><span class="line">       android:layout_marginTop=&quot;200dp&quot;</span><br><span class="line">       app:layout_constraintTop_toTopOf=&quot;parent&quot;</span><br><span class="line">       app:layout_constraintWidth_default=&quot;percent&quot;</span><br><span class="line">       app:layout_constraintWidth_percent=&quot;0.4&quot;</span><br><span class="line">       android:background=&quot;#332211&quot;&gt;&lt;/View&gt;</span><br></pre></td></tr></table></figure>
<p><img src="http://7xjrms.com1.z0.glb.clouddn.com/QQ20171219-094800@2x.png" alt></p>
<h4 id="barrier"><a href="#barrier" class="headerlink" title="barrier"></a>barrier</h4><p>当我们的界面布局因为内容的变化而改变时，布局有时候会出现错乱的情况。比如View在两个TextView的右边，但是我们只能设置View的layout_constraintLeft_toRightOf其中的一个TextView，当另一个TextView的文字长度变化时，就会超过并与View重叠，而如果TextView设置layout_constraintRight_toLeftOf时，又会限制TextView的宽度。这时，我们就可以用到barrier了。</p>
<p>关于barrier的详细介绍，可以参考<a href="http://www.jcodecraeer.com/a/anzhuokaifa/androidkaifa/2017/1017/8601.html" target="_blank" rel="noopener">ConstraintLayout之Barrier</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;TextView</span><br><span class="line">       android:id=&quot;@+id/v1&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;100dp&quot;</span><br><span class="line">       android:text=&quot;dadsadsadasdsadsads&quot;</span><br><span class="line">       app:layout_constraintTop_toTopOf=&quot;parent&quot;</span><br><span class="line">       &gt;&lt;/TextView&gt;</span><br><span class="line"></span><br><span class="line">   &lt;TextView</span><br><span class="line">       android:id=&quot;@+id/view&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_marginTop=&quot;100dp&quot;</span><br><span class="line">       app:layout_constraintTop_toTopOf=&quot;parent&quot;</span><br><span class="line">       android:text=&quot;dadsadsadasdsadsadsdsadsadsa&quot;</span><br><span class="line">       &gt;&lt;/TextView&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   &lt;android.support.constraint.Barrier</span><br><span class="line">       android:id=&quot;@+id/Barrier&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">       app:barrierDirection=&quot;right&quot;</span><br><span class="line">       app:constraint_referenced_ids=&quot;v1,view&quot;/&gt;</span><br><span class="line"></span><br><span class="line">   &lt;View</span><br><span class="line">       android:id=&quot;@+id/view2&quot;</span><br><span class="line">       android:layout_width=&quot;10dp&quot;</span><br><span class="line">       android:layout_height=&quot;match_parent&quot;</span><br><span class="line">       android:background=&quot;#ff0000&quot;</span><br><span class="line">       app:layout_constraintLeft_toRightOf=&quot;@+id/Barrier&quot;</span><br><span class="line">       app:layout_constraintTop_toTopOf=&quot;parent&quot;&gt;&lt;/View&gt;</span><br></pre></td></tr></table></figure>
<p>barrier在这里是一个不可见的控件，但是它可以帮我们添加约束条件。这里我们看到，我们设置了app:barrierDirection=”right”，说明约束条件为右，同时将设置constraint_referenced_ids设置barrier的childview。最后将View的layout_constraintLeft_toRightOf设置为barrier。</p>
<p>效果图：</p>
<p><img src="http://7xjrms.com1.z0.glb.clouddn.com/QQ20171219-102847@2x.png" alt></p>
<h4 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h4><p>Group顾名思义就是将多个View放在Group中进行统一处理。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> &lt;TextView</span><br><span class="line">       android:id=&quot;@+id/v1&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;100dp&quot;</span><br><span class="line">       android:text=&quot;dadsadsadasdsadsads&quot;</span><br><span class="line">       app:layout_constraintTop_toTopOf=&quot;parent&quot;</span><br><span class="line">       &gt;&lt;/TextView&gt;</span><br><span class="line"></span><br><span class="line">   &lt;TextView</span><br><span class="line">       android:id=&quot;@+id/view&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_marginTop=&quot;100dp&quot;</span><br><span class="line">       app:layout_constraintTop_toTopOf=&quot;parent&quot;</span><br><span class="line">       android:text=&quot;dadsadsadasdsadsadsdsadsadsa&quot;</span><br><span class="line">       &gt;&lt;/TextView&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;android.support.constraint.Group</span><br><span class="line">       android:id=&quot;@+id/group&quot;</span><br><span class="line">       android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">       android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">       app:constraint_referenced_ids=&quot;v1,view&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>当我们在代码中设置group.setVisibility(View.GONE)时，两个TextView都会消失。</p>
<h4 id="Placeholder"><a href="#Placeholder" class="headerlink" title="Placeholder"></a>Placeholder</h4><p>Placeholder 可以将自己的内容替换为其他View，所以它可以用来写布局模板，也可以动态修改UI内容。</p>
<h5 id="用作模板"><a href="#用作模板" class="headerlink" title="用作模板"></a>用作模板</h5><p>模板xml：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;merge</span><br><span class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:parentTag=&quot;android.support.constraint.ConstraintLayout&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.constraint.Placeholder</span><br><span class="line">        android:id=&quot;@+id/template_save&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:content=&quot;@+id/save&quot;</span><br><span class="line">        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintHorizontal_chainStyle=&quot;spread&quot;</span><br><span class="line">        app:layout_constraintEnd_toStartOf=&quot;@+id/template_delete&quot;</span><br><span class="line">        app:layout_constraintStart_toStartOf=&quot;parent&quot;</span><br><span class="line">         /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.constraint.Placeholder</span><br><span class="line">        android:id=&quot;@+id/template_delete&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:content=&quot;@+id/delete&quot;</span><br><span class="line">        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintEnd_toStartOf=&quot;@+id/template_cancel&quot;</span><br><span class="line">        app:layout_constraintStart_toEndOf=&quot;@+id/template_save&quot;</span><br><span class="line">        /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.constraint.Placeholder</span><br><span class="line">        android:id=&quot;@+id/template_cancel&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:content=&quot;@+id/cancel&quot;</span><br><span class="line">        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintEnd_toStartOf=&quot;@+id/template_edit&quot;</span><br><span class="line">        app:layout_constraintStart_toEndOf=&quot;@+id/template_delete&quot;</span><br><span class="line">         /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.constraint.Placeholder</span><br><span class="line">        android:id=&quot;@+id/template_edit&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:content=&quot;@+id/edit&quot;</span><br><span class="line">        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintEnd_toEndOf=&quot;parent&quot;</span><br><span class="line">        app:layout_constraintStart_toEndOf=&quot;@+id/template_cancel&quot;</span><br><span class="line">         /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/merge&gt;</span><br></pre></td></tr></table></figure>
<p>Placeholder中都设置了   app:content=”id”，表示需要替换的View的id。</p>
<p>真正的布局文件：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;android.support.constraint.ConstraintLayout</span><br><span class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;include layout=&quot;@layout/temp&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/save&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:srcCompat=&quot;@mipmap/two_point&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/edit&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:srcCompat=&quot;@mipmap/three_point&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/cancel&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:srcCompat=&quot;@mipmap/four_point&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:id=&quot;@+id/delete&quot;</span><br><span class="line">        android:layout_width=&quot;48dp&quot;</span><br><span class="line">        android:layout_height=&quot;48dp&quot;</span><br><span class="line">        app:srcCompat=&quot;@mipmap/five_point&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/android.support.constraint.ConstraintLayout&gt;</span><br></pre></td></tr></table></figure>
<p>这里模板文件需要放在最前面。</p>
<p>最后看看效果图：</p>
<p><img src="http://7xjrms.com1.z0.glb.clouddn.com/QQ20171219-111332@2x.png" alt></p>
<h5 id="动态替换"><a href="#动态替换" class="headerlink" title="动态替换"></a>动态替换</h5><p>Placeholder可以在代码中动态替换掉代替的View</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mPlaceholder= (Placeholder) findViewById(R.id.template_action);</span><br><span class="line">        findViewById(R.id.save).setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onClick(View v) &#123;</span><br><span class="line">                mPlaceholder.setContentId(v.getId());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<p>这里的save是不能用Placeholder代替。</p>
<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>在1.1版本中，我们可以看到ConstraintLayout的功能越来越多，不仅可以更好的减少代码层级，还可以代替掉一部分逻辑层的代码。</p>
</div><div class="article-meta" style="max-width:800px"><div class="tags"><i class="icon icon-tag"></i><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ConstraintLayout/">ConstraintLayout</a><span class="tag-list-count">2</span></li></ul></div><div class="categories"><i class="icon icon-category"></i><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ConstraintLayout/">ConstraintLayout</a><span class="category-list-count">2</span></li></ul></div></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="ck85r7lum0076fxo11theioon" data-title="ConstraintLayout 1.1新功能" data-url="https://earthwo.github.io/2017/12/18/ConstraintLayout-1-1新功能/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2017/12/19/WebView与Js交互/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2017/12/18/ConstraintLayout初步探究/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/earthWo" title="Github" target="_blank"><i class="icon icon-github"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2020 alonealice<br><small><a href="http://www.beian.miit.gov.cn" target="_blank">浙ICP备17033688号</a></small><small>, THEME BY <a href="https://github.com/BoizZ/hexo-theme-laughing" target="_blank">LAUGHING</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>